{{- $fen := .Get "fen" -}}
{{- if not $fen -}}
  <p>Error: FEN string not provided.</p>
{{- else -}}
  {{- $board := (split (index (split $fen " ") 0) "/") -}}
  <div class="chessboard">
    {{- range $rowIndex, $row := $board -}}
    {{- $colIndex := 0 -}}
    {{- range $charIndex, $char := $row -}}
      {{- if eq $char "1" -}}
          {{- $colIndex = add $colIndex 1 -}}
      {{- else if eq $char "2" -}}
          {{- $colIndex = add $colIndex 2 -}}
      {{- else if eq $char "3" -}}
          {{- $colIndex = add $colIndex 3 -}}
      {{- else if eq $char "4" -}}
          {{- $colIndex = add $colIndex 4 -}}
      {{- else if eq $char "5" -}}
          {{- $colIndex = add $colIndex 5 -}}
      {{- else if eq $char "6" -}}
          {{- $colIndex = add $colIndex 6 -}}
      {{- else if eq $char "7" -}}
          {{- $colIndex = add $colIndex 7 -}}
      {{- else if eq $char "8" -}}
          {{- $colIndex = add $colIndex 8 -}}
      {{- else -}}
        {{- $isLightSquare := (mod (add $rowIndex $colIndex) 2) -}}
        <div class="square {{ if eq $isLightSquare 0 }}light{{ else }}dark{{ end }}">
          {{- if $char -}}
            <span class="piece">{{ $char }}</span>
          {{- end -}}
        </div>
         {{- $colIndex = add $colIndex 1 -}}
      {{- end -}}
    {{- end -}}
    {{- end -}}
  </div>
{{- end -}}
